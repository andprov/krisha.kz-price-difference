# Парсер сайта аренды недвижимости krisha.kz

[krisha.kz](https://krisha.kz/)

Позволяет проводить анализ разницы стоимости и кол-ва объявлений аренды недвижимости за два выбранных дня.

Работа основана на сравнении двух **.csv** файлов с данными полученными по заданным параметрам.

## Установка:

Клонировать репозиторий.

```
git clone https://github.com/andprov/krisha.kz-price-difference.git
```

Перейти в папку проекта.

```
cd krisha.kz-price-difference
```

Создать виртуальное окружение.

Для OS на основе Debian возможно предварительно потребуется выполнить команду - `sudo apt-get install python3-venv`

```
python3 -m venv .venv
```

Активировать виртуальное окружение.

```
source .venv/bin/activate
```

Установить библиотеки.

```
python3 -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

## Запуск и использование:

Открыть блокнот **krisha_kz.ipynb** в [VSCode](https://code.visualstudio.com/) или [Jupyter Notebook](https://jupyter.org/)

Задать параметры поиска.

```python
ps.rental_data(
    city=2,
    furniture=True,
    room=4,
    price_from=300000,
    price_to=500000,
    owner=True,
)
```

### Параметры поиска объявлений:

-   `city`: `int` - Город поиска. Доступен выбор от 0 до 20;
-   `furniture`: `bool` - Наличие мебели;
-   `room`: `int` - Количество комнат. Доступен выбор от 0 до 4;
-   `price_from`: `int` - Стоимость, нижний предел;
-   `price_to`: `int` - Стоимость, верхний предел;
-   `owner`: `bool` - Объявление опубликовано собственником;

    #### Варианты значения `city`:

    -   0 Весь Казахстан
    -   1 Алматы
    -   2 Астана
    -   3 Шымкент
    -   4 Абайская обл.
    -   5 Акмолинская обл.
    -   6 Актюбинская обл.
    -   7 Алматинская обл.
    -   8 Атырауская обл.
    -   9 Восточно-Казахстанская обл.
    -   10 Жамбылская обл.
    -   11 Жетысуская обл.
    -   12 Западно-Казахстанская обл.
    -   13 Карагандинская обл.
    -   14 Костанайская обл.
    -   15 Кызылординская обл.
    -   16 Мангистауская обл.
    -   17 Павлодарская обл.
    -   18 Северо-Казахстанская обл.
    -   19 Туркестанская обл.
    -   20 Улытауская обл.

Задать имена файлов для сравнения.

Перед первым выполнением кода, для исключения ошибки отсутствия файла `FileNotFoundError: [Errno 2] No such file or directory:` в названиях файлов необходимо указать текущую дату - "data/**YYYY-MM-DD**\_flats.csv".

```python
flats_old = pd.read_csv("data/2023-01-01_flats.csv")
flats_new = pd.read_csv("data/2023-01-01_flats.csv")
```

## Результат

После успешного сбора информации, в корневой директории проекта создается папка **data**. В папку помещается **.csv** файл с данными. В имени файла будет текущая дата **YYYY-MM-DD_flats.csv**.
На следующие сутки и далее появляется возможность сравнивать сохраненные файлы за прошлые даты между собой и файл получаемый на текущий момент, меняя названия файлов в параметрах.

**График разницы предложений аренды между двумя днями (кол-во и стоимость):**

![График](https://github.com/andprov/img/blob/main/plt.png?raw=true)

**Таблица с данными:**

![Таблица](https://github.com/andprov/img/blob/main/tbl.png?raw=true)

**Короткая сводка по кол-ву объявлений определенной стоимости:**

![Сводка](https://github.com/andprov/img/blob/main/q.png?raw=true)
